window.addEventListener("load",()=>{const canvas=document.getElementsByClassName("bg_canvas")[0],c=canvas.getContext("2d");canvas.width=250,canvas.height=250;const image=c.createImageData(250,250);for(let i=0;i<image.data.length;i+=4)image.data[i]=0,image.data[i+1]=0,image.data[i+2]=0,image.data[i+3]=255;const distance=(x,y)=>Math.sqrt(x*x+y*y),heightMap1=[];for(let u=0;u<500;u++)for(let v=0;v<500;v++){const i=500*u+v,d=distance(u-250,v-250),stretch=2*Math.PI/250,normalized=(Math.sin(d*stretch)+1)/2;heightMap1[i]=Math.floor(128*normalized)}const heightMap2=[];for(let u=0;u<500;u++)for(let v=0;v<500;v++){const i=500*u+v,cx=u-500,cy=v-250,d1=.005*distance(.05*cx,.05*cy),d2=5*distance(.05*cx,.09*cy),normalized=(Math.sin(d1)+Math.cos(d2)+2)/4;heightMap2[i]=Math.floor(127*normalized)}const interpolate=(c1,c2,f)=>({r:Math.floor(c1.r+(c2.r-c1.r)*f),g:Math.floor(c1.g+(c2.g-c1.g)*f),b:Math.floor(c1.b+(c2.b-c1.b)*f)}),makePalette=()=>makeFiveColorGradient({r:14,g:6,b:20},{r:18,g:13,b:41},{r:35,g:17,b:71},{r:87,g:60,b:138},{r:136,g:127,b:194}),makeFiveColorGradient=(c1,c2,c3,c4,c5)=>{const g=[];for(let i=0;i<64;i++){const f=i/64;g[i]=interpolate(c1,c2,f)}for(let i=64;i<128;i++){const f=(i-64)/64;g[i]=interpolate(c2,c3,f)}for(let i=128;i<192;i++){const f=(i-128)/64;g[i]=interpolate(c3,c4,f)}for(let i=192;i<256;i++){const f=(i-192)/64;g[i]=interpolate(c4,c5,f)}return g};let dx1=0,dy1=0,dx2=0,dy2=0;const palettes=[makePalette(),makePalette()];let palette=[],prevDirection=1;const tick=time=>{var t;t=time,dx1=Math.floor((Math.cos(2e-4*t+.3+Math.PI)+1)/2*500/2),dy1=Math.floor((Math.cos(5e-4*t-.1)+1)/2*500/2),dx2=Math.floor((Math.cos(-1e-4*t+.1)+1)/2*500/2),dy2=Math.floor((Math.cos(-2e-4*t-5+Math.PI)+1)/2*500/2),(t=>{const x=5e-4*t,inter=(Math.cos(x)+1)/2,direction=-Math.sin(x)>=0?1:-1;prevDirection!=direction&&(prevDirection=direction,-1==direction?palettes[0]=makePalette():palettes[1]=makePalette());for(let i=0;i<256;i++)palette[i]=interpolate(palettes[0][i],palettes[1][i],inter)})(time),(()=>{for(let u=0;u<250;u++)for(let v=0;v<250;v++){const k=500*(u+dy2)+(v+dx2),j=250*u*4+4*v;let h=heightMap1[500*(u+dy1)+(v+dx1)]+heightMap2[k],c=palette[h];image.data[j]=c.r,image.data[j+1]=c.g,image.data[j+2]=c.b}})(),c.putImageData(image,0,0),requestAnimationFrame(tick)};requestAnimationFrame(tick)});